{% extends 'base.html' %}
{% block content %}
  <h3>Search students (VULNERABLE)</h3>
  <form method="post" class="row g-2">
    {% csrf_token %}
    <div class="col-md-6">
      <input class="form-control" name="search_name" placeholder="Enter name to search" value="{{ search_name }}">
    </div>
    <div class="col-auto">
      <button class="btn btn-primary">Search</button>
    </div>
  </form>

  {% if executed_query %}
    <div class="mt-3"><small class="text-muted">Executed (vulnerable) SQL:</small>
      <pre class="bg-light p-2">{{ executed_query }}</pre>
    </div>
  {% endif %}

  {% if rows %}
    <table class="table table-striped mt-3">
      <thead><tr><th>ID</th><th>Code</th><th>Name</th><th>Address</th><th>Class</th></tr></thead>
      <tbody>
      {% for r in rows %}
        <tr>
          <td>{{ r.id }}</td>
          <td>{{ r.ma_sv }}</td>
          <td>{{ r.ten_sv }}</td>
          <td>{{ r.dia_chi }}</td>
          <td>{{ r.lop }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  {% endif %}

  <p class="small-muted">Tip: try SQLi payload <code>x' OR '1'='1</code> in search to see vulnerable behavior.</p>
{% endblock %}
